% -----------------------------------------------------------------------------
% Copyright Toby Davis
% See LICENSE for details
% -----------------------------------------------------------------------------

% === Draft Mode ===
\IfFileExists{draft.flag}{
    % Set draft flag
    \newcommand{\draft}{true}
}{
    \newcommand{\draft}{false}
}

\newcommand{\ifdraft}[1]{\ifthenelse{\equal{\draft}{true}}{#1}{}}

% === Inline Code Macro ===
\newcommand{\code}[1]{\texttt{#1}}

% === Colored Boxes ===

% -- Generic colored box (color passed as argument) --
\newtcolorbox{coloredboxImpl}[2]{%
    colback=#1!5!white,
    colframe=#1,
    sharp corners,
    title={#2}
}

\newenvironment{coloredbox}[2]{
    \nolinenumbers
    \begin{coloredboxImpl}{#1}{#2}
        }{%
    \end{coloredboxImpl}
    \ifdraft{\linenumbers}
}

% -- Grey box --
\newtcolorbox{greyboxImpl}[1]{%
    colback=black!5!white,
    colframe=white!25!black,
    sharp corners,
    title={#1}
}

\newenvironment{greybox}[1]{
    \nolinenumbers
    \begin{greyboxImpl}{#1}
        }{%
    \end{greyboxImpl}
    \ifdraft{\linenumbers}
}

% -- Red box --
\newtcolorbox{redboxImpl}[1]{%
    colback=myRed!5!white,
    colframe=myDarkRed,
    sharp corners,
    title={#1}
}

\newenvironment{redbox}[1]{
    \nolinenumbers
    \begin{redboxImpl}{#1}
        }{%
    \end{redboxImpl}
    \ifdraft{\linenumbers}
}

% -- Blue box --
\newtcolorbox{blueboxImpl}[1]{%
    colback=myBlue!5!white,
    colframe=myDarkBlue,
    sharp corners,
    title={#1}
}

\newenvironment{bluebox}[1]{
    \nolinenumbers
    \begin{blueboxImpl}{#1}
        }{%
    \end{blueboxImpl}
    \ifdraft{\linenumbers}
}

% -- Green box --
\newtcolorbox{greenboxImpl}[1]{%
    colback=myGreen!5!white,
    colframe=myDarkGreen,
    sharp corners,
    title={#1}
}

\newenvironment{greenbox}[1]{
    \nolinenumbers
    \begin{greenboxImpl}{#1}
        }{%
    \end{greenboxImpl}
    \ifdraft{\linenumbers}
}

% -- Code box --
\newtcolorbox{codeboxImpl}[1]{%
    colback=blue!3!white,
    colframe=white!50!black,
    sharp corners,
    title={\faCode \quad #1}
}

\newenvironment{codebox}[1]{
    \nolinenumbers
    \begin{codeboxImpl}{#1}
        }{%
    \end{codeboxImpl}
    \ifdraft{\linenumbers}
}

% === Theorem-like Environments ===
\newmdtheoremenv{theorem}{Theorem}
\newmdtheoremenv{lemma}{Lemma}
\newmdtheoremenv{corollary}{Corollary}
\newmdtheoremenv{proposition}{Proposition}

% === C++ Macro ===
\newcommand\CPP{C\nolinebreak[4]\hspace{-.05em}\raisebox{.4ex}{\relsize{-3}{\textbf{++}}}}

% === Subtitle Command ===
\newcommand{\subtitle}[1]{%
    \posttitle{%
        \par\end{center}
        \begin{center}\Large#1\end{center}
        \vskip0.5em}%
}

% === PGF/TikZ Utility Command ===
\NewDocumentCommand{\pgfPlotIfNotNaN}{ m }{%
    \pgfmathfloatifflags{#1}{3}%
    {}% If NaN, do nothing
    {\pgfmathprintnumber{#1}}% If not NaN, print the number
}

% === Page Referencing Command ===
\newcommand{\ztotpagesminusone}{\getpagerefnumber{LastPage}}
